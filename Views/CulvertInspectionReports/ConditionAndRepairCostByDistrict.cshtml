@model IEnumerable<ERA_BMS.Models.CulvertConditionAndRepairCostByDistrict>

@{
    ViewBag.Title = "Culvert Condition & Repair Cost By District";
}

<h2>Culvert Condition and Repair Cost By District</h2>

<div class="panel panel-primary">
    <div class="panel-heading">
        <h3 class="panel-title panel-info">Summary of Culvert <b>Condition</b> and <b>Repair Cost</b> By District</h3>
    </div>

    <div class="panel-body">
        <br />
        <br />
        <table class="table table-striped table-bordered table-condensed table-responsive display compact hover" id="tblculvertconditionandbudgetbydistrict">
            <thead>
                <tr>
                    <th rowspan="2">
                        @Html.DisplayNameFor(model => model.District)
                    </th>
                    <th></th>
                    <th colspan="4" style="text-align: center">
                        No. of Culverts by Damage Conditions
                    </th>
                    <th rowspan="2">
                        @*@Html.DisplayNameFor(model => model.EstimatedBudget)*@
                        Total Damage Repair Cost
                    </th>
                    
                </tr>
            </thead>

            <thead>
                <tr>
                    <th></th>
                    <th></th>
                    <th>
                        @Html.DisplayNameFor(model => model.Good)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Fair)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Bad)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Total)
                    </th>
                    
                    
                </tr>
            </thead>

            <tbody>
                @{ int totalGood = 0;
                    int totalFair = 0;
                    int totalBad = 0;
                    int totalCulvert = 0;
                    double totalBudget = 0.0;
                }
                @foreach (var item in Model)
                {
                    <tr>
                        @{
                            float sum = (float)(item.Good + item.Fair + item.Bad);
                        }
                        <td>
                            <h5>@Html.DisplayFor(modelItem => item.District)</h5>
                        </td>
                        <td>
                            <br />
                            Total Culvert
                            <br /><br />
                            <i>Percentage</i>
                        </td>
                        <td>
                            <br />
                            @item.Good
                            @{
                                totalGood += (int)item.Good;
                            }
                            <br /><br />
                            @{
                                float goodPerc = ((float)item.Good / sum) * 100;
                            }
                            <i>@goodPerc.ToString("0.00")</i>
                        </td>
                        <td>
                            <br />
                            @item.Fair
                            @{
                                totalFair += (int)item.Fair;
                            }
                            <br /><br />
                            @{
                                float fairPerc = ((float)item.Fair / sum) * 100;
                            }
                            <i>@fairPerc.ToString("0.00")</i>
                        </td>
                        <td>
                            <br />
                            @item.Bad
                            @{
                                totalBad += (int)item.Bad;
                            }
                            <br /><br />
                            @{
                                float badPerc = ((float)item.Bad / sum) * 100;
                            }
                            <i>@badPerc.ToString("0.00")</i>
                        </td>
                        <td>
                            <br />
                            @item.Total
                            @{
                                totalCulvert += (int)item.Total;
                            }
                        </td>
                        <td>
                            <br />
                            @item.RepairCost.ToString("#,0.00")
                            @{
                                totalBudget += (int)item.RepairCost;
                            }
                        </td>
                    </tr>
                }
                <tr>
                    <th><h5>Total</h5></th>
                    <th></th>
                    <th><h5><b>@totalGood.ToString("0,0")</b></h5></th>
                    <th><h5><b>@totalFair.ToString("0,0")</b></h5></th>
                    <th><h5><b>@totalBad.ToString("0,0")</b></h5></th>
                    <th><h5><b>@totalCulvert.ToString("0,0")</b></h5></th>
                    <th><h5><b>@totalBudget.ToString("#,0.00")</b></h5></th>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="panel-footer">
        <h3 class="panel-title">Total No. of Districts: <strong>@Model.Count()</strong></h3>
    </div>
</div>

<script>
    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();

        $('#tblculvertconditionandbudgetbydistrict').dataTable({
            paging: true,
            pageLength: 15,
            bLengthChange: true,
            scrollY: 400,
            searching: true,
            select: true,
            dom: 'lBfrtip',
            buttons: [
                { extend: 'copy', className: 'btn btn-sm btn-primary' },
                { extend: 'excel', className: 'btn btn-sm btn-primary', text: 'Export Excel' },
                { extend: 'pdf', className: 'btn btn-sm btn-primary', text: 'Export PDF' },
                { extend: 'print', className: 'btn btn-sm btn-primary' }
            ]
        });
    });
</script>
