@model IEnumerable<ERA_BMS.Models.Segment>

<div class="panel panel-primary">
    
    <div class="panel-heading">
        <h3 class="panel-title panel-info">District: <b>@ViewBag.DistrictName</b> | Section: <b>@ViewBag.SectionName</b></h3>
    </div>
    <div class="panel-body">
        <table class="table table-striped table-condensed table-responsive display compact hover" align="center" id="tbltrafficedata">
            <thead>
                <tr>
                    <th>
                        @Html.DisplayNameFor(model => model.SegmentNo)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.RoadId)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.RevisedRoadId)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.SegmentName)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.AverageDailyTraffic) <i style="color:red">(Click/Tap to Edit)</i>
                    </th>
                </tr>
            </thead>

            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                           <span> @item.SegmentNo</span>
                        </td>
                        <td>
                           <span> @item.RoadId</span>
                        </td>
                        <td>
                           <span> @item.RevisedRoadId</span>
                        </td>
                        <td>
                            <span>@item.SegmentName</span>
                        </td>
                        <td>
                            <span class="ADT" name="@item.SegmentId">@item.AverageDailyTraffic</span>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
    <div class="panel-footer">
        <h3 class="panel-title">Total of <b>@Model.Count()</b> Segment(s) in District <b>@ViewBag.DistrictName</b> and Section <b>@ViewBag.SectionName</b> </h3>
    </div>
</div>

<script>
    $(document).ready(function () {
        makeAverageDailyTrafficEditable();

        // A function that makes "Average Daily Traffic" editable
        function makeAverageDailyTrafficEditable() {
            $(".ADT").each(function () {
                $(this).editable("/TrafficData/UpdateTrafficData", {
                    callback: function (value, settings) {
                        $(this).html(jQuery.parseJSON(settings.data)[value]);
                    },
                    submitdata: function () {
                        return {
                            // Pass parameters to "UpdateTrafficData" action in "Routes" controller action
                            id: $(this).attr("name"),
                            origvalue: this.revert,
                        };
                    },
                    tooltip: 'Click or Tap to edit...',
                    placeholder: '-',
                    indicator: 'Saving...',
                    select: true, // highlight all text after editable
                    size: 4
                });
            });
        }
    });
</script>